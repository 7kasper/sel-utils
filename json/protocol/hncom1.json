{

	"__software": "SEL hub-node communication",
	"__protocol": 1,
	"__website": "https://github.com/sel-project/sel-utils",

	"encoding": {

		"endianness": {
			"*": "big-endian"
		},

		"id": "ubyte",

		"array_length": "varuint",

		"types": {

			"plugin": {
				"type": "struct",
				"fields": [
					{
						"name": "name",
						"type": "string"
					},
					{
						"name": "version",
						"type": "string"
					}
				]
			},

			"address": {
				"type": "struct",
				"fields": [
					{
						"name": "is_ipv6",
						"type": "bool"
					},
					{
						"name": "bytes4",
						"when": "is_ipv6==false",
						"type": "ubyte[4]"
					},
					{
						"name": "bytes6",
						"when": "is_ipv6==true",
						"type": "ubyte[16]"
					},
					{
						"name": "port",
						"type": "ushort"
					}
				]
			},

			"game": {
				"type": "struct",
				"fields": [
					{
						"name": "type",
						"type": "ubyte"
					},
					{
						"name": "protocols",
						"type": "uint[]"
					},
					{
						"name": "motd",
						"type": "string"
					},
					{
						"name": "port",
						"type": "ushort"
					}
				]
			},

			"skin": {
				"type": "struct",
				"fields": [
					{
						"name": "empty",
						"type": "bool"
					},
					{
						"name": "name",
						"when": "empty==false",
						"type": "string"
					},
					{
						"name": "data",
						"when": "empty==false",
						"type": "ubyte[]"
					}
				]
			},

			"logged_message": {
				"type": "struct",
				"fields": [
					{
						"name": "timestamp",
						"type": "ulong"
					},
					{
						"name": "logger",
						"type": "string"
					},
					{
						"name": "message",
						"type": "string"
					}
				]
			},

			"player": {
				"type": "struct",
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "position",
						"type": "float<xyz>"
					}
				]
			}

		}

	},

	"packets": {

		"login": {

			"connection": {
				"id": 0,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "protocol",
						"type": "varuint"
					},
					{
						"name": "name",
						"type": "string"
					},
					{
						"name": "main_node",
						"type": "bool"
					}
				]
			},

			"connection_response": {
				"id": 1,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "protocol_accepted",
						"type": "bool"
					},
					{
						"name": "name_accepted",
						"type": "bool"
					}
				]
			},

			"info": {
				"id": 2,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "online_mode",
						"type": "bool"
					},
					{
						"name": "display_name",
						"type": "string"
					},
					{
						"name": "games",
						"type": "game[]"
					},
					{
						"name": "language",
						"type": "string"
					},
					{
						"name": "accepted_languages",
						"type": "string[]"
					},
					{
						"name": "social_json",
						"type": "string"
					},
					{
						"name": "additional_json",
						"type": "string"
					}
				]
			},

			"ready": {
				"id": 3,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "plugins",
						"type": "plugin[]"
					}
				]
			}

		},

		"status": {

			"players": {
				"id": 4,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "online",
						"type": "varuint"
					},
					{
						"name": "max",
						"type": "varuint"
					}
				]
			},

			"nodes": {
				"id": 5,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "nodes",
						"type": "string[]"
					}
				]
			},

			"update_nodes": {
				"id": 6,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "type",
						"type": "ubyte"
					},
					{
						"name": "node",
						"type": "string"
					}
				]
			},

			"server_resource_usage": {
				"id": 7,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "tps",
						"type": "float"
					},
					{
						"name": "ram_used",
						"type": "ulong"
					},
					{
						"name": "cpu_used",
						"type": "float"
					}
				]
			}

		},

		"play": {

			"add_player": {
				"id": 8,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "reason",
						"type": "ubyte"
					},
					{
						"name": "protocol",
						"type": "varuint"
					},
					{
						"name": "username",
						"type": "string"
					},
					{
						"name": "display_name",
						"type": "string"
					},
					{
						"name": "address",
						"type": "address"
					},
					{
						"name": "game",
						"type": "ubyte"
					},
					{
						"name": "uuid",
						"type": "uuid"
					},
					{
						"name": "skin",
						"type": "skin"
					},
					{
						"name": "latency",
						"type": "varuint"
					},
					{
						"name": "language",
						"type": "string"
					}
				]
			},

			"kick_player": {
				"id": 9,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "reason",
						"type": "string"
					},
					{
						"name": "translation",
						"type": "bool"
					}
				]
			},

			"player_disconnected": {
				"id": 10,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "reason",
						"type": "ubyte"
					}
				]
			},

			"transfer_player": {
				"id": 11,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "node",
						"type": "string"
					}
				]
			},

			"update_player_language": {
				"id": 12,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "language",
						"type": "string"
					}
				]
			},

			"update_player_display_name": {
				"id": 13,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "display_name",
						"type": "string"
					}
				]
			},
			
			"update_list": {
				"id": 14,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "list",
						"type": "ubyte"
					},
					{
						"name": "action",
						"type": "ubyte"
					},
					{
						"name": "type",
						"type": "ubyte"
					}
				],
				"variants": {
					"field": "type",
					"values": {
						"by_hub_id": {
							"value": 0,
							"fields": [
								{
									"name": "hub_id",
									"type": "varuint"
								}
							]
						},
						"by_name": {
							"value": 1,
							"fields": [
								{
									"name": "username",
									"type": "string"
								}
							]
						},
						"by_suuid": {
							"value": 2,
							"fields": [
								{
									"name": "game",
									"type": "ubyte"
								},
								{
									"name": "uuid",
									"type": "uuid"
								}
							]
						}
					}
				}
			},

			"game_packet": {
				"id": 15,
				"clientbound": true,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "packet",
						"type": "remaining_bytes"
					}
				]
			},

			"ordered_game_packet": {
				"id": 16,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "order",
						"type": "varuint"
					},
					{
						"name": "packet",
						"type": "remaining_bytes"
					}
				]
			},

			"remote_command": {
				"id": 17,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "origin",
						"type": "ubyte"
					},
					{
						"name": "sender",
						"type": "address"
					},
					{
						"name": "command",
						"type": "string"
					}
				]
			},

			"update_player_latency": {
				"id": 18,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "latency",
						"type": "varuint"
					}
				]
			},

			"update_player_packet_loss": {
				"id": 19,
				"clientbound": true,
				"serverbound": false,
				"fields": [
					{
						"name": "hub_id",
						"type": "varuint"
					},
					{
						"name": "packet_loss",
						"type": "float"
					}
				]
			},

			"log": {
				"id": 20,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "message",
						"type": "logged_message"
					}
				]
			},

			"logs": {
				"id": 21,
				"clientbound": false,
				"serverbound": true,
				"fields": [
					{
						"name": "messages",
						"type": "logged_message[]"
					}
				]
			}

		}

	}

}
