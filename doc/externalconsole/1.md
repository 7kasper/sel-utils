# External Console 1

Protocol used by SEL to communicate with external sources using TCP or web sockets.

--------

## Endianness

every type: big endian

--------

## Packets

Section | Packets
---|:---:
[Login](#login) | 3
[Status](#status) | 3
[Play](#play) | 3

### Login

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Auth Credentials](#auth-credentials) | 0 | 0 | ✓ | 
[Auth](#auth) | 1 | 1 |  | ✓
[Welcome](#welcome) | 2 | 2 | ✓ | 

* ### Auth Credentials

	**ID**: 0

	**Clientbound**: yes

	**Serverbound**: no

	Credentials for login.

	**Fields**:

	* protocol

		**Type**: ubyte

		Protocol used by the server. If the client uses a different one it should close the connection without sending any packet.

	* hashAlgorithm

		**Type**: string

		Algorithm used by the server to match the the hash. If empty no hashing is done and the password is sent raw.

	* payload

		**Type**: ubyte[16]

		Payload to add to the password encoded as UTF-8 (if hash algorithm is not empty) before hashing it.


* ### Auth

	**ID**: 1

	**Clientbound**: no

	**Serverbound**: yes

	**Fields**:

	* hash

		**Type**: ubyte[]


* ### Welcome

	**ID**: 2

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	* status

		**Type**: ubyte


	**Variants**:

	**Field**: status

	* Accepted

		**Field's value**: 0

		**Additional Fields**:

		* remoteCommands

			**Type**: bool

		* software

			**Type**: string

		* versions

			**Type**: ubyte[3]

		* displayName

			**Type**: string

		* protocols

			**Type**: [game](#game)[]

		* connectedNodes

			**Type**: string[]


	* Wrong Hash

		**Field's value**: 1

	* Timed Out

		**Field's value**: 2

### Status

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Keep Alive](#keep-alive) | 0 | 0 | ✓ | ✓
[Update Nodes](#update-nodes) | 1 | 1 | ✓ | 
[Update Stats](#update-stats) | 2 | 2 | ✓ | 

* ### Keep Alive

	**ID**: 0

	**Clientbound**: yes

	**Serverbound**: yes

	**Fields**:

	* count

		**Type**: uint


* ### Update Nodes

	**ID**: 1

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	* action

		**Type**: ubyte

		**Constants**:

		Name | Value
		---|:---:
		add | 0
		remove | 1

	* node

		**Type**: string


* ### Update Stats

	**ID**: 2

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	* onlinePlayers

		**Type**: uint

	* maxPlayers

		**Type**: uint

	* uptime

		**Type**: uint

	* upload

		**Type**: uint

	* download

		**Type**: uint

	* nodes

		**Type**: [nodeStats](#node-stats)[]


### Play

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Console Message](#console-message) | 3 | 3 | ✓ | 
[Command](#command) | 4 | 4 |  | ✓
[Permission Denied](#permission-denied) | 5 | 5 | ✓ | 

* ### Console Message

	**ID**: 3

	**Clientbound**: yes

	**Serverbound**: no

	Logs a message from the server's console. It may be a result of a command, a debug message or any other message that the server retains able to be seen by the External Console.

	**Fields**:

	* node

		**Type**: string

		Name of the node that has created the log or an empty string if the log has been created by the hub or by a server implementation that isn't based on the hub-node structure.

	* timestamp

		**Type**: ulong

		Unix timestamp in milliseconds that indicates the exact time when the log has been generated by the server.

	* logger

		**Type**: string

		Name of the logger. It is the world name if the log has been generated by a world's message (like a broadcast or a chat message).

	* message

		**Type**: string

		The logged message. It may contain Minecraft's formatting codes which should be translated into appropriate colours by the client-side implementation.


* ### Command

	**ID**: 4

	**Clientbound**: no

	**Serverbound**: yes

	Executes a command remotely if the server allows it. If not a [Permission Denied](#permission-denied) is sent back. The ideal client should never send this packet if remoteCommands field in [Welcome.Accepted](#accepted) is not true.

	**Fields**:

	* command

		**Type**: string

		Command to be executed on the server. On SEL servers it should start with a slash or a point (hub command) or a node name followed by the command (node command).


* ### Permission Denied

	**ID**: 5

	**Clientbound**: yes

	**Serverbound**: no

	Bodyless packet only sent in response to [Command](#command) when the server doesn't allow the execution of remote commands through the External Console protocol. The ideal client should never receive this packet avoiding the use of [Command](#command) if the remoteCommands field in [Welcome.Accepted](#accepted) is not true.

--------

## Types

* ### Game

	**Fields**:

	* type

		**Type**: ubyte

		**Constants**:

		Name | Value
		---|:---:
		pocket | 1
		minecraft | 2

	* protocols

		**Type**: uint[]


* ### Node Stats

	**Fields**:

	* name

		**Type**: string

	* tps

		**Type**: float

	* ram

		**Type**: ulong

	* cpu

		**Type**: float


