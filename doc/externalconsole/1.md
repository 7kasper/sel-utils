# External Console 1

**Jump to**: [Endianness](#endianness), [Packets](#packets), [Types](#types)

Protocol used by SEL to communicate with external sources using TCP or web sockets.

--------

## Endianness

every type: big endian

--------

## Packets

Section | Packets
---|:---:
[Login](#login) | 3
[Status](#status) | 3
[Play](#play) | 3

### Login

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Auth Credentials](#login.auth-credentials) | 0 | 0 | ✓ | 
[Auth](#login.auth) | 1 | 1 |  | ✓
[Welcome](#login.welcome) | 2 | 2 | ✓ | 

<a name="login.auth-credentials"></a>
* ### Auth Credentials

	**ID**: 0

	**Clientbound**: yes

	**Serverbound**: no

	Credentials for login.

	**Fields**:

	Name | Type
	---|---
	[protocol](#login.auth-credentials.protocol) | ubyte
	[hashAlgorithm](#login.auth-credentials.hash-algorithm) | string
	[payload](#login.auth-credentials.payload) | ubyte[16]

	* <a name="login.auth-credentials.protocol"></a>**protocol**

		Protocol used by the server. If the client uses a different one it should close the connection without sending any packet.

	* <a name="login.auth-credentials.hash-algorithm"></a>**hashAlgorithm**

		Algorithm used by the server to match the the hash. If empty no hashing is done and the password is sent raw.

	* <a name="login.auth-credentials.payload"></a>**payload**

		Payload to add to the password encoded as UTF-8 (if hash algorithm is not empty) before hashing it.


<a name="login.auth"></a>
* ### Auth

	**ID**: 1

	**Clientbound**: no

	**Serverbound**: yes

	**Fields**:

	Name | Type
	---|---
	hash | ubyte[]


<a name="login.welcome"></a>
* ### Welcome

	**ID**: 2

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	Name | Type
	---|---
	status | ubyte


	**Variants**:

	Variant | Field | Value
	---|---|:---:
	[Accepted](#login.welcome.accepted) | status | 0
	[Wrong Hash](#login.welcome.wrong-hash) | status | 1
	[Timed Out](#login.welcome.timed-out) | status | 2

	* <a name="login.welcome.accepted"></a>**Accepted**

		**Additional Fields**:

		Name | Type
		---|---
		remoteCommands | bool
		software | string
		versions | ubyte[3]
		displayName | string
		protocols | [game](#types.game)[]
		connectedNodes | string[]


	* <a name="login.welcome.wrong-hash"></a>**Wrong Hash**

	* <a name="login.welcome.timed-out"></a>**Timed Out**

### Status

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Keep Alive](#status.keep-alive) | 0 | 0 | ✓ | ✓
[Update Nodes](#status.update-nodes) | 1 | 1 | ✓ | 
[Update Stats](#status.update-stats) | 2 | 2 | ✓ | 

<a name="status.keep-alive"></a>
* ### Keep Alive

	**ID**: 0

	**Clientbound**: yes

	**Serverbound**: yes

	**Fields**:

	Name | Type
	---|---
	count | uint


<a name="status.update-nodes"></a>
* ### Update Nodes

	**ID**: 1

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	Name | Type
	---|---
	[action](#status.update-nodes.action) | ubyte
	node | string

	* <a name="status.update-nodes.action"></a>**action**

		**Constants**:

		Name | Value
		---|:---:
		add | 0
		remove | 1


<a name="status.update-stats"></a>
* ### Update Stats

	**ID**: 2

	**Clientbound**: yes

	**Serverbound**: no

	**Fields**:

	Name | Type
	---|---
	onlinePlayers | uint
	maxPlayers | uint
	uptime | uint
	upload | uint
	download | uint
	nodes | [nodeStats](#types.node-stats)[]


### Play

Packet | DEC | HEX | Clientbound | Serverbound
---|:---:|:---:|:---:|:---:
[Console Message](#play.console-message) | 3 | 3 | ✓ | 
[Command](#play.command) | 4 | 4 |  | ✓
[Permission Denied](#play.permission-denied) | 5 | 5 | ✓ | 

<a name="play.console-message"></a>
* ### Console Message

	**ID**: 3

	**Clientbound**: yes

	**Serverbound**: no

	Logs a message from the server's console. It may be a result of a command, a debug message or any other message that the server retains able to be seen by the External Console.

	**Fields**:

	Name | Type
	---|---
	[node](#play.console-message.node) | string
	[timestamp](#play.console-message.timestamp) | ulong
	[logger](#play.console-message.logger) | string
	[message](#play.console-message.message) | string

	* <a name="play.console-message.node"></a>**node**

		Name of the node that has created the log or an empty string if the log has been created by the hub or by a server implementation that isn't based on the hub-node structure.

	* <a name="play.console-message.timestamp"></a>**timestamp**

		Unix timestamp in milliseconds that indicates the exact time when the log has been generated by the server.

	* <a name="play.console-message.logger"></a>**logger**

		Name of the logger. It is the world name if the log has been generated by a world's message (like a broadcast or a chat message).

	* <a name="play.console-message.message"></a>**message**

		The logged message. It may contain Minecraft's formatting codes which should be translated into appropriate colours by the client-side implementation.


<a name="play.command"></a>
* ### Command

	**ID**: 4

	**Clientbound**: no

	**Serverbound**: yes

	Executes a command remotely if the server allows it. If not a [Permission Denied](#permission-denied) is sent back. The ideal client should never send this packet if remoteCommands field in [Welcome.Accepted](#accepted) is not true.

	**Fields**:

	Name | Type
	---|---
	[command](#play.command.command) | string

	* <a name="play.command.command"></a>**command**

		Command to be executed on the server. On SEL servers it should start with a slash or a point (hub command) or a node name followed by the command (node command).


<a name="play.permission-denied"></a>
* ### Permission Denied

	**ID**: 5

	**Clientbound**: yes

	**Serverbound**: no

	Bodyless packet only sent in response to [Command](#command) when the server doesn't allow the execution of remote commands through the External Console protocol. The ideal client should never receive this packet avoiding the use of [Command](#command) if the remoteCommands field in [Welcome.Accepted](#accepted) is not true.

--------

## Types

<a name="types.game"></a>
* ### Game

	**Fields**:

	Name | Type
	---|---
	[type](#game.type) | ubyte
	protocols | uint[]

	* <a name="game.type"></a>**type**

		**Constants**:

		Name | Value
		---|:---:
		pocket | 1
		minecraft | 2


<a name="types.node-stats"></a>
* ### Node Stats

	**Fields**:

	Name | Type
	---|---
	name | string
	tps | float
	ram | ulong
	cpu | float


